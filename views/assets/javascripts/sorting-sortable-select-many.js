!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){"use strict";function t(n,i){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,e.isPlainObject(i)&&i),this.init()}var n=window.Mustache,i=window.Sortable,a=window._,o="qor.chooser.sortable",r="enable."+o,d="click."+o,s="disable."+o,l=".chosen-container-multi",c=".search-choice",h=".chosen-container",u=".qor-dragable",f=".qor-dragable__list",p=".qor-dragable__list-handle",b=".qor-dragable__list-delete",_=".qor-dragable__list-data",m=".qor-dragable__button-add",g="load-sortable-select-many";return t.prototype={constructor:t,init:function(){var t=this.$element,n=t.parents(u),a=this;this.$selector=n.find(_),this.$sortableList=n.find(f),this.$parent=n;var o=n.find(f)[0];this.sortable=i.create(o,{animation:150,handle:p,filter:b,dataIdAttr:"data-index",onFilter:function(t){var n=e(t.item),i=n.data("index");n.remove(),a.removeItems(i)},onUpdate:function(){a.renderOption()}}),t.prop("multiple")||(t.children("[selected]").length?t.prepend('<option value=""></option>'):t.prepend('<option value="" selected></option>')),t.on("chosen:ready",function(t,i){e(i.chosen.search_field).attr("placeholder",this.$element.data("placeholder")),n.find(c).hide(),n.find(h).hide()}.bind(this)),t.chosen({allow_single_deselect:!0,search_contains:!0,disable_search_threshold:10,width:"100%",display_selected_options:!1}).on("change",function(t,i){var a=e(t.target),o=a.next(l),r=i.selected;o.size()&&(n.find(c).hide(),r&&this.addItems(r))}.bind(this)),this.bind()},bind:function(){this.$parent.on(d,m,this.show.bind(this))},unbind:function(){this.$parent.off(d,m,this.show)},show:function(){this.$parent.find(h).show().find(".search-field input").click(),this.$parent.find(m).hide()},renderItem:function(e){return n.render(t.LIST_HTML,e)},renderOption:function(){var e=this.sortable.toArray(),i=this.$selector;i.empty(),a.each(e,function(e){i.append(n.render(t.OPTION_HTML,{value:e}))})},removeItems:function(e){var t=this.$element,n=t.find('[data-index="'+e+'"]'),i=t.find("option").index(n);this.$parent.find(c).find('[data-option-array-index="'+i+'"]').click(),this.renderOption()},addItems:function(e){var t=this.$element,n=t.find('option[value="'+e+'"]').data();this.$sortableList.append(this.renderItem(n)),this.renderOption()},destroy:function(){this.sortable.destroy(),this.unbind(),this.$element.chosen("destroy").removeData(o)}},t.DEFAULTS={},t.LIST_HTML='<li data-index=[[index]] data-value=[[value]]><span>[[value]]</span><i class="material-icons qor-dragable__list-delete">clear</i><i class="material-icons qor-dragable__list-handle">drag_handle</i></li>',t.OPTION_HTML="<option selected value=[[value]]></option>",t.plugin=function(n){return this.each(function(){var i,a=e(this),r=a.data(o);if(!r){if(!e.fn.chosen)return;if(/destroy/.test(n))return;a.data(o,r=new t(this,n))}"string"==typeof n&&e.isFunction(i=r[n])&&i.apply(r)})},e(function(){var n='select[data-toggle="qor.chooser.sortable"]';e("body").data(g)||(e("body").data(g,"true"),e(document).on(s,function(i){t.plugin.call(e(n,i.target),"destroy")}).on(r,function(i){t.plugin.call(e(n,i.target))}).triggerHandler(r))}),t});
//# sourceMappingURL=sorting-sortable-select-many.js.map
